# Тестирование на доступность

### Введение
В этом уроке вы узнаете, как тестировать и улучшать доступность ваших приложений.

Люди с ослабленным зрением, дальтоники, слабослышащие, с ослабленной ловкостью рук, с когнитивными нарушениями и многими другими ограниченными возможностями используют устройства Android для выполнения повседневных задач. Когда вы разрабатываете приложения с учетом доступности, вы делаете пользовательский опыт лучше, особенно для пользователей с этими и другими потребностями в доступности.

В ходе этого урока вы будете использовать TalkBack и Switch Access для проверки доступности приложения Woof.


TalkBack позволяет пользователям управлять своими устройствами без помощи глаз.
Switch Access позволяет пользователям перемещаться по приложению с помощью переключателей, а не сенсорного экрана.

### Что вы узнаете

- Как взаимодействовать с приложением с помощью TalkBack.
- Как взаимодействовать с приложением с помощью Switch Access вместо сенсорного экрана.
- Как оптимизировать пользовательский интерфейс для повышения доступности.

### Что вам понадобится

- Компьютер с установленной программой Android Studio.
- Android-устройство или эмулятор, имеющий доступ к приложению Google Play Store, или уже установленный Android Accessibility Suite.
- Код решения для приложения `Woof`.

### Подготовка к работе

## Настройте ваше устройство

Если на вашем устройстве или эмуляторе уже установлен Android Accessibility Suite, эту часть можно пропустить. Если вам необходимо установить Android Accessibility Suite (для доступа к TalkBack и Switch Access), следуйте приведенным ниже инструкциям.

> Примечание: Рекомендуется использовать физическое устройство для этого коделаба, если оно у вас есть. Если у вас есть физическое устройство, вам не придется выполнять следующие шаги по настройке.

Настройка устройства с помощью приложения Google Play Store
Если вы используете физическое устройство, убедитесь, что вы:


Имейте доступ к приложению Play Store.
Выполнен вход в учетную запись Google.
На вашем устройстве имеются необходимые разрешения для загрузки приложений из приложения Play Store.
Если вы используете эмулятор, выполните следующие действия, чтобы настроить эмулятор с доступом к приложению Play Store:


В Android Studio откройте диспетчер устройств и выберите Создать устройство.
Убедитесь, что вы выбрали Pixel 8 или любое другое устройство со значком приложения Play Store в колонке Play Store. Значок означает, что этот эмулятор поставляется с приложением Google Play Store.


![](https://developer.android.com/static/codelabs/basic-android-kotlin-compose-test-accessibility/img/fef200739a6b0e6d_856.png)

Нажмите кнопку Next и продолжите создание эмулятора. Если вам нужно узнать, как завершить создание нового профиля оборудования, посмотрите видео в этом разделе codelab.
После создания эмулятора запустите его из диспетчера устройств, нажав на значок со стрелкой.


![](https://developer.android.com/static/codelabs/basic-android-kotlin-compose-test-accessibility/img/91619522d628e743_856.png)

> Примечание: Если вы не видите программу запуска приложений Play Store в указанном ниже месте, вы можете найти ее на экране «Все приложения».


![](https://developer.android.com/static/codelabs/basic-android-kotlin-compose-test-accessibility/img/f5bb7cf9f5ae9410_856.png)


Установите приложение Android Accessibility Suite
Android Accessibility Suite содержит набор приложений для обеспечения доступности. Оно понадобится вам для использования TalkBack и Switch Access далее в этом кодебалете.


В приложении Google Play Store установите приложение <a href=«https://play.google.com/store/apps/details?id=com.google.android.marvin.talkback»>Android Accessibility Suite</a>.


![](https://developer.android.com/static/codelabs/basic-android-kotlin-compose-test-accessibility/img/942030e19c564e59_856.png)

Установите приложение Woof
Если вы создали новый профиль оборудования Pixel 4 в начале этого раздела, вам нужно установить приложение Woof из загруженного кода решения.


# 3. Использование Woof с TalkBack
TalkBack - это программа для чтения с экрана от Google, которая обеспечивает голосовую обратную связь, чтобы пользователи могли перемещаться по устройству, не глядя на экран. Это особенно полезно для людей с ослабленным зрением.

Если TalkBack включен, пользователи могут перемещаться по устройству с помощью голосовой обратной связи и жестов - например, взмахов и касаний. Навигация с помощью TalkBack - это отличный способ проверить, есть ли в вашем приложении области, требующие улучшения.

Выполните следующие шаги, чтобы лучше освоить TalkBack:

> Примечание: Когда TalkBack включен, нажмите, чтобы выбрать элемент, а затем дважды нажмите, чтобы активировать его. Для пролистывания и навигации по системе используйте два пальца.

Посмотрите следующее видео, чтобы узнать, как настроить и использовать TalkBack.

[видео]

Как только вы ознакомитесь с TalkBack, примените полученные знания в приложении Woof!

> Примечание: звук TalkBack на эмуляторе может быть низким или некачественным. В этом случае попробуйте увеличить громкость на эмуляторе.

Прежде чем перейти к следующему разделу, отключите функцию TalkBack. Чтобы отключить функцию Talkback, выполните следующие действия:
На устройстве или эмуляторе откройте «Настройки».

Выберите Доступность, а затем TalkBack.

Отключите функцию TalkBack.

Выберите Ok.

Другие способы отключения TalkBack можно найти в документации поддержки. Имейте в виду, что некоторые из этих опций невозможны на эмуляторе, а другие могут быть устаревшими на некоторых версиях Android.

# 4. Использование Woof с Switch Access
Switch Access позволяет взаимодействовать с устройством Android с помощью одного или нескольких переключателей вместо сенсорного экрана. Эта альтернатива сенсорному экрану особенно полезна для пользователей с ограниченной ловкостью рук.

Switch Access сканирует элементы на экране, поочередно выделяя каждый из них, пока вы не сделаете выбор.

Чтобы использовать Switch Access, вам понадобится один или несколько переключателей. Существует несколько видов переключателей, но в этом коделабе мы будем использовать встроенные кнопки громкости на устройстве Android.

> Если вы настроили кнопки громкости в соответствии с инструкциями видеоролика, Switch Access позволяет нажимать кнопку уменьшения громкости для перехода к различным элементам в приложении. Когда элемент выделен, его можно выбрать с помощью кнопки увеличения громкости.
Для элементов с простым действием нажатия выбор элемента аналогичен действию касания. Для элементов, для которых доступны пользовательские действия доступности, при выборе элемента пользователю предлагаются различные действия, которые он может совершить с этим элементом.

При включенном Switch Access в верхней части экрана устройства появляется вкладка Menu. При выборе вкладки открывается глобальное меню с навигационными опциями, такими как Назад и Домой, которые эквивалентны жестам на экране устройства. Некоторые опции настраивают поведение Switch Access.

Как только вы ознакомитесь с Switch Access, примените полученные знания к приложению Woof!
Отключите Switch Access, прежде чем переходить к следующему разделу.

# 5. Улучшение доступности пользовательского интерфейса
При попытке создать более доступное приложение необходимо учитывать ряд особенностей дизайна пользовательского интерфейса. В дополнение к атрибутам и поведению, которые позволяют эффективно использовать TalkBack и Switch Access, ниже приведены некоторые оптимизации пользовательского интерфейса, которые вы можете сделать для улучшения доступности вашего приложения.

Описание содержимого
Пользователи служб доступности, таких как устройства чтения с экрана (например, TalkBack), полагаются на описание содержимого, чтобы понять смысл элементов интерфейса.

В некоторых случаях, например, когда информация передается графически в элементе, описание содержимого может содержать текстовое описание значения или действия, связанного с элементом.

Если элементы пользовательского интерфейса не снабжены метками содержания, некоторым пользователям может быть сложно понять представленную им информацию или выполнить действия в интерфейсе. В Compose вы можете описывать визуальные элементы с помощью атрибута contentDescription. Для чисто декоративных визуальных элементов можно установить значение contentDescription равным null. Подробнее о том, как применять описания содержимого, читайте в документации.

Размер цели касания
Любой экранный элемент, с которым кто-то может взаимодействовать, должен быть достаточно большим для надежного взаимодействия. Минимальный размер сенсорной цели для кликабельного элемента - 48dp в высоту x 48dp в ширину. Существует ряд компонентов Material Design, для которых Compose автоматически назначает правильный минимальный целевой размер. Помните, что минимальный размер цели касания относится к кликабельным компонентам размером менее 48dp. Компоненты размером более 48dp будут иметь сенсорную цель размером не менее размера компонента. Дополнительную информацию о размере цели касания можно найти на этих ресурсах:

Взгляните на код приложения Woof. В файле MainActivity.kt компонент DogItemButton использует компонент IconButton.

```kt
@Composable
private fun DogItemButton(
   expanded: Boolean,
   onClick: () -> Unit,
   modifier: Modifier = Modifier
) {
   IconButton(onClick = onClick) {
       Icon(
           imageVector = if (expanded) Icons.Filled.ExpandLess else Icons.Filled.ExpandMore,
           tint = MaterialTheme.colors.secondary,
           contentDescription = stringResource(R.string.expand_button_content_description),
       )
   }
}
```

IconButton - это компонент Material Design. В документации к композитному компоненту IconButton указано, что минимальный размер цели касания составляет 48 x 48 dp.

Приведенный ниже код является исходным кодом для IconButton. Обратите внимание, что модификатор устанавливает минимальный размер цели касания (minimumTouchTargetSize()).

```kt
@Composable
fun IconButton(
   onClick: () -> Unit,
   modifier: Modifier = Modifier,
   enabled: Boolean = true,
   interactionSource: MutableInteractionSource = remember { MutableInteractionSource() },
   content: @Composable () -> Unit
) {
   Box(
       modifier = modifier
           .minimumTouchTargetSize()
           .clickable(
               onClick = onClick,
               enabled = enabled,
               role = Role.Button,
               interactionSource = interactionSource,
               indication = rememberRipple(bounded = false, radius = RippleRadius)
           ),
       contentAlignment = Alignment.Center
   ) {
       val contentAlpha = if (enabled) LocalContentAlpha.current else ContentAlpha.disabled
       CompositionLocalProvider(LocalContentAlpha provides contentAlpha, content = content)
   }
}
```

> Примечание: Код, который вы видите выше для IconButton, не может быть найден непосредственно в коде приложения Woof. Это исходный код для IconButton, который поставляется из библиотеки Compose Material. В качестве дополнительного шага, если вы хотите найти этот код самостоятельно, вы можете щелкнуть правой кнопкой мыши на вызове IconButton в MainActivity и выбрать Go To > Declaration or Usages.

Цветовой контраст
Цвета, которые вы выбираете для интерфейса приложения, влияют на то, насколько легко пользователи могут читать и понимать его. Достаточный цветовой контраст облегчает чтение и восприятие текста и изображений.

Достаточный цветовой контраст не только полезен для пользователей с различными нарушениями зрения, но и помогает всем пользователям при просмотре интерфейса на устройствах в экстремальных условиях освещения, например под прямыми солнечными лучами или на дисплее с низкой яркостью.

Подробнее о том, как оптимизировать цветовой контраст, можно прочитать в справочной документации по доступности Android. По этой ссылке вы найдете информацию о коэффициентах контрастности, которая поможет вам принять решение о том, какие цвета использовать. Кроме того, вы можете использовать этот инструмент для проверки фоновых и передних цветов на достаточный коэффициент цветового контраста. Для мелкого текста рекомендуется соотношение 4,5 : 1, а для крупного - 3,0 : 1.

Для приложения Woof наш дизайнер выбрал цвета и убедился, что они достаточно контрастны. Создавая собственное приложение, не забывайте проверять цветовой контраст. В инструменте Color Tool для Material Design есть вкладка доступности, где вы можете увидеть подходящие цвета текста поверх основных и дополнительных цветов.

### Заключение

Важно помнить о доступности при создании новых приложений и добавлении новых функций в существующие. Интегрируя функции и сервисы доступности, вы сможете повысить удобство использования приложения, особенно для пользователей с ограниченными возможностями.
